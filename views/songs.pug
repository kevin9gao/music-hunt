extends layout.pug
append head
    link(rel='stylesheet' href='/stylesheets/song-page.css')
    script(src="/javascripts/song-page.js" type="module" defer)
block content
    table
        thead
            tr
                th Album Art
                th Song Name
                th Song Artist
                th Play Song
                th Description
                th Upvotes

        tbody
            each song in songs
                - let link = song.urlLink.replace(".com/", ".com/embed/") //changes the spotify link to a url that can be embedded
                - count =0
                - let artistName = users[song.artistId - 1].username // gets the name of the user that posted the song

                each songUpvote in songUpvotes
                    if (songUpvote.songId === song.id)
                        - count +=1
                tr
                    td
                        img(src=song.albumArt class="songPic" height="150px" width="150px")
                    td#myButton= 'test'
                        button
                        div#myModal
                            div#modalContent
                                span#close= 'X'
                                p= 'test'
                    td
                        a(href=`/songs/${artistName}`)= artistName
                    td
                     iframe(style = "border-radius:12px" src = `${link.slice(0, -20)}?utm_source=generator` width = "100%" height = "80" frameBorder = "0" allowfullscreen = "" allow = "autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture")

                    td= song.description
                    td= count
                    td
                        form(action=`/songs/upvote/${song.id}` method="post")
                            button Upvote

    //- div(idstyle="height: 100px; width: 100px; background-color: orange")
