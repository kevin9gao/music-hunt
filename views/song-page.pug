extends layout
append head
  link(rel='stylesheet' href='/stylesheets/song-page.css')
  script(src="/javascripts/song-page.js" type="module" defer)
block content
  div#main-header
      div#routes
        a.text-style-1(href="/") Home
        span.text-style-1 →
        a.text-style-1(href="/songs") Songs
        span.text-style-1 →
        a.text-style-1(href=`/songs/${song.name}/${song.id}`)= song.name
      div#song-container
        div
          img(src=song.albumArt)
        div#song-info
          div
            h1#song-name= song.name
            h2#artist-name= song.User.username
          div#visit-upvote-container
            if locals.authenticated
              if locals.user.username === song.User.username
                form(action=`/songs/${song.id}/delete` method="post")
                  button#delete-button
                    div#delete-text-1 Delete
                    div#delete-text-2 Song?
                //- TODO Change to href='profile page'
            button#upvote-button
              div#upvote-container
                div#upvote-img
                div#upvote-text UPVOTE ###
      div#description
        p= song.description
        div
          - let link = song.urlLink.replace(".com/", ".com/embed/") //changes the spotify link to a url that can be embedded
          iframe(
            style = "border-radius:12px" src = `${link.slice(0, -20)}?utm_source=generator`
            width = "100%" height = "380" frameBorder = "0" allowfullscreen = ""
            allow = "autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture")
  div#related-title
    //- TODO Include img link to be song.User.profilePic
    img(src=song.albumArt).img-size-1
    div More from this artist . . .
  div#related-container.text-style-1
      each song in relatedSongs
        a(href=`/songs/${song.name}/${song.id}`).related-song
          img(src=song.albumArt).img-size-2
          div.centered= song.name
  div#comment-container test
      div#comment-container
        form(action='/songs/comments/new' method='post')
          input(type='hidden' name='_csrf' value=csrfToken)
          textarea(name='body' required)
          input(type='hidden' name='songId' value=song.id)
          input(type='hidden' name='songName' value=song.name)
          button Comment
      div#comments
